cmake_minimum_required(VERSION 3.10.2)

project("kyberjni")

# ğŸ”¹ C í‘œì¤€ ì§€ì •
set(CMAKE_C_STANDARD 99)
set(CMAKE_C_EXTENSIONS OFF)

# ğŸ”¹ Kyber ì†ŒìŠ¤ ë””ë ‰í† ë¦¬ ì •ì˜
set(KYBER_DIR ${CMAKE_SOURCE_DIR}/kyber)

# ğŸ”¹ Kyber ê´€ë ¨ C íŒŒì¼ ëª©ë¡
file(GLOB KYBER_SRC
        ${KYBER_DIR}/*.c
)

# ğŸ”¹ JNI C íŒŒì¼ ëª…ì‹œ (ì§ì ‘ ì§€ì •)
set(JNI_SRC
        ${KYBER_DIR}/kyber_jni.c
)

# ğŸ”¹ ì „ì²´ íŒŒì¼ ì§€ì •
set(ALL_SRC
        ${KYBER_SRC}
        ${JNI_SRC}
)

# ğŸ”¹ C ì†ŒìŠ¤ë¡œ ê°•ì œ ì§€ì •
set_source_files_properties(${ALL_SRC} PROPERTIES LANGUAGE C)

# ğŸ”¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„±
add_library(
        kyberjni
        SHARED
        ${ALL_SRC}
)

# ğŸ”¹ log ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¾ê¸°
find_library(
        log-lib
        log
)

# ğŸ”¹ í—¤ë” ë””ë ‰í† ë¦¬ ë“±ë¡
target_include_directories(
        kyberjni
        PRIVATE
        ${KYBER_DIR}
)

# ğŸ”¹ log ë§í¬
target_link_libraries(
        kyberjni
        ${log-lib}
)
